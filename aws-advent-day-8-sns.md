Amazon Simple Notification Service
----------------------------------

[Amazon Simple Notification Service (SNS)](http://aws.amazon.com/sns/) is a web service which helps you easily publish and deliver notifications to a variety of end points in an automated and low cost fashion. SNS currently supports sending messages to Email, SMS, HTTP/S, and SQS Queue endpoints.

You're able to use SNS through the [AWS console](https://console.aws.amazon.com), the [SNS CLI tools](http://aws.amazon.com/developertools/3688) or through the [SNS API](http://docs.amazonwebservices.com/sns/latest/api/Welcome.html?r=123).

The moving parts
----------------

SNS is composed of three main parts

1. A topic
2. A subscription
3. Published messages

A _topic_ is a communication channel to send messages and subscribe to notifications. Once you create a topic, you're provided with a _topic ARN (Amazon Resource Name)_, which you'll use for subscriptions and publishing messages.

A _subscription_ is done to a specific endpoint of a topic. This can be a web service, an email address or an [SQS queue](http://docs.amazonwebservices.com/AWSSimpleQueueService/latest/SQSGettingStartedGuide/CreatingQueue.html). 

_Published messages_ are generated by _publishers_, which can be scripts calling the SNS API, users using the AWS console, or using the CLI tools. Once a new message is published, Amazon SNS attempts to deliver that message to every endpoint that is subscribed to the topic.

Costs
------

SNS has a number of cost factors, [including API requests, notifications to HTTP/S, notifications to Email, notifications to SMS, and data transferred out of a region](http://aws.amazon.com/sns/#pricing).

You can get started using SNS with [AWS's Free Usage tier](http://aws.amazon.com/free) though. So you won't have to _pay to play_ right away.

Using SNS
---------

To get started with using SNS, we'll walk through making a topic, creating an email subscription, and publishing a message, all through the AWS console.

__Making a topic__

1. Login to the [AWS Console](https://console.aws.amazon.com/sns/)
2. Click Create New Topic.
3. Enter a topic name in the Topic Name field.
4. Click Create Topic.
5. Copy the Topic ARN for the next task.

You're now ready to make a subscription.

__Creating an email subscription__

1. In the [AWS Console](https://console.aws.amazon.com/sns/) click on My Subscriptions
2. Click the Create New Subscription button.
3. In the Topic ARN field, paste the topic ARN you created in the previous task, for example: 
	`arn:aws:sns:us-east-1:054794666397:MyTopic.`
4. Select Email in the Protocol drop-down box.
5. Enter your email address for the notification in the Endpoint field.
5. Click Subscribe.
6. Go to your email and open the message from AWS Notifications, and then click the link to confirm your subscription.
7. You should see a confirmation response from SNS

You're now ready to publish a message.

__Publishing a message__

1. In the [AWS Console](https://console.aws.amazon.com/sns/) click the topic you want to publish to, under My Topics in the Navigation pane.
2. Click the Publish to Topic button.
3. Enter a subject line for your message in the Subject field.
4. Enter a brief message in the Message field.
5. Click Publish Message.
6. A confirmation dialog box will appear, click Close to close the confirmation dialog box.
7. You should get the email shortly.

The [SNS documentation](http://docs.amazonwebservices.com/sns/) has more details on:

* [Create Different Messages for Each Protocol](http://docs.amazonwebservices.com/sns/latest/gsg/Publish.html)
* [Managing Permissions on your SNS Topics](http://docs.amazonwebservices.com/sns/latest/gsg/AccessPolicyLanguage.html)
* [Sending/Recieving SMS Notifications](http://docs.amazonwebservices.com/sns/latest/gsg/SMSMessages.html)
* [Using SQS Queues with SNS](http://docs.amazonwebservices.com/sns/latest/gsg/SendMessageToSQS.html)
* [Sending Messages to HTTP/S Endpoints](http://docs.amazonwebservices.com/sns/latest/gsg/SendMessageToHttp.html)
* [Message and JSON Formats](http://docs.amazonwebservices.com/sns/latest/gsg/json-formats.html)

Automating SNS
--------------

You've learned how to manually work with SNS, but as with all AWS services, things are best when automated.

Building on Day 4's post, [Getting Started with Boto](http://awsadvent.tumblr.com/post/37251281257/getting-started-with-boto), we'll walk through automating SNS with some [boto](https://github.com/boto/boto) scripts.

__Making a topic__

This script will connect to __us-west-2__ and create a topic named _adventtopic_. 

If the topic is successfully created, it will return the _topic ARN_. Otherwise, it will log any errors to _sns-topic.log_.

_sns-topic.py_

<pre>

</pre>

__Making an email subscription__

This script will connect to __us-west-2__ and create an email subscription to the topic named _adventtopic_ for the email address you specify. 

If the subscription is successfully created, it will return the _topic ARN_. Otherwise, it will log any errors to _sns-topic.log_.

* _Note: You'll need to manually confirm the subscription in your email client before you can move on to using the pre for publishing a message._

_sns-email-sub.py_

<pre>

</pre>

__Publishing a message__

This script will connect to __us-west-2__ and create a message to the topic named _adventtopic_ with the subject and message body you specify.

If the publication is successfully performed, it will return the _topic ARN_. Otherwise, it will log any errors to _sns-publish.log_.

_sns-publish.py_

<pre>

</pre>

Final thoughts
--------------

At this point you've successfully automated the main use cases for SNS. 

As you can see, SNS can be very useful for sending notifications and with a little automation, can quickly become a part of your application infrastructure toolkit.

All the code samples are available in the [Github repository](https://github.com/solarce/awsadvent2012).




